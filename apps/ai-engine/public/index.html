<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Engine Control Panel</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header with Status Bar -->
        <header class="header">
            <div class="header-top">
                <h1>ü§ñ AI Engine Control Panel</h1>
                <div class="theme-toggle">
                    <button id="theme-toggle-btn" onclick="toggleTheme()" title="Toggle Dark/Light Theme">
                        <span id="theme-icon">üåô</span>
                    </button>
                </div>
            </div>
            <div class="status-bar">
                <span id="embedding-status">Embedding: <span id="embedding-provider">Loading...</span></span>
                <span id="completion-status">Completion: <span id="completion-provider">Loading...</span></span>
                <span id="service-status">Status: <span id="status-indicator">‚óè</span> <span id="status-text">Loading...</span></span>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="tab-button active" onclick="showTab('rag')">Knowledge Base (RAG)</button>
            <button class="tab-button" onclick="showTab('generation')">Content Generation</button>
            <button class="tab-button" onclick="showTab('moderation')">Content Moderation</button>
        </nav>

        <!-- RAG Tab -->
        <div id="rag-tab" class="tab-content active">
            <!-- RAG Pipeline Flow Diagram -->
            <div class="flow-diagram">
                <div class="flow-title">RAG Pipeline Status</div>
                <div class="flow-container">
                    <span class="flow-step idle" id="step-ingest">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üìÑ</div>
                            <div class="flow-step-name">INGEST</div>
                            <div class="flow-step-tech">Go API</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="step-embed">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üß†</div>
                            <div class="flow-step-name">EMBED</div>
                            <div class="flow-step-tech" id="embed-tech">Ollama</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="step-store">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üóÑÔ∏è</div>
                            <div class="flow-step-name">STORE</div>
                            <div class="flow-step-tech">Weaviate</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="step-query">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚ùì</div>
                            <div class="flow-step-name">QUERY</div>
                            <div class="flow-step-tech">Go API</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="step-retrieve">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üîç</div>
                            <div class="flow-step-name">RETRIEVE</div>
                            <div class="flow-step-tech">Weaviate</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="step-generate">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚ö°</div>
                            <div class="flow-step-name">GENERATE</div>
                            <div class="flow-step-tech" id="completion-tech">Ollama</div>
                        </div>
                    </span>
                </div>
            </div>

            <div class="section">
                <h2>üìÑ 1. Ingest Knowledge</h2>
                <div class="input-group">
                    <label for="document-text">Paste document content here:</label>
                    <textarea id="document-text" placeholder="Paste Telar documentation, API specs, or any content about the platform you want to add to the knowledge base..."></textarea>
                </div>
                <div class="quick-content">
                    <strong>Quick Load:</strong>
                    <button onclick="loadReadme()">Load README.md</button>
                    <button onclick="loadContributing()">Load CONTRIBUTING.md</button>
                    <button onclick="loadCodeOfConduct()">Load CODE_OF_CONDUCT.md</button>
                    <button onclick="clearDocument()">Clear</button>
                </div>
                <div class="input-group">
                    <label for="source-metadata">Source (metadata):</label>
                    <input type="text" id="source-metadata" placeholder="docs/readme.md" value="demo/document">
                </div>
                <button id="ingest-btn" onclick="handleIngest()">üì• Ingest Knowledge</button>
                <div id="ingest-status" class="status-message"></div>
            </div>

            <div class="section">
                <h2>‚ùì 2. Query Knowledge Base</h2>
                <div class="input-group">
                    <label for="query-input">Ask a question about the ingested knowledge:</label>
                    <input type="text" id="query-input" placeholder="e.g., What is Telar? What are the AI-powered features? What is the tech stack?">
                </div>
                <button id="query-btn" onclick="handleQuery()">üîç Ask Question</button>
            </div>

            <div class="section">
                <h2>üí° 3. Results</h2>
                <div class="result-container">
                    <h3>Answer:</h3>
                    <div id="answer-display" class="answer-box markdown-content"></div>
                </div>
                <div class="result-container" id="sources-section" style="display: none;">
                    <h3>üìö Sources Used (RAG Evidence):</h3>
                    <div id="sources-display" class="sources-box"></div>
                </div>
            </div>
        </div>

        <!-- Generation Tab -->
        <div id="generation-tab" class="tab-content">
            <!-- Content Generation Flow Diagram -->
            <div class="flow-diagram">
                <div class="flow-title">Content Generation Pipeline Status</div>
                <div class="flow-container">
                    <span class="flow-step idle" id="gen-step-input">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üìù</div>
                            <div class="flow-step-name">INPUT</div>
                            <div class="flow-step-tech">User Input</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="gen-step-process">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚öôÔ∏è</div>
                            <div class="flow-step-name">PROCESS</div>
                            <div class="flow-step-tech">Go API</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="gen-step-generate">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üé®</div>
                            <div class="flow-step-name">GENERATE</div>
                            <div class="flow-step-tech" id="gen-completion-tech">Ollama</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="gen-step-format">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üìã</div>
                            <div class="flow-step-name">FORMAT</div>
                            <div class="flow-step-tech">Go API</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="gen-step-output">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚ú®</div>
                            <div class="flow-step-name">OUTPUT</div>
                            <div class="flow-step-tech">UI Display</div>
                        </div>
                    </span>
                </div>
            </div>

            <div class="section">
                <h2>üé® Generate Conversation Starters</h2>
                <div class="input-group">
                    <label for="community-topic">Community Topic:</label>
                    <input type="text" id="community-topic" placeholder="e.g., AI-powered social features, Go backend development, Open-source platforms">
                </div>
                <div class="input-group">
                    <label for="style-preference">Style:</label>
                    <input type="text" id="style-preference" placeholder="e.g., Developer-friendly, Community-focused, Technical" value="Developer-friendly">
                </div>
                <button id="generate-btn" onclick="handleGenerate()">Generate Ideas</button>
                <div id="generate-status" class="status-message"></div>
            </div>

            <div class="section">
                <h2>üìä Concurrent Request Status</h2>
                <div class="input-group">
                    <button id="status-btn" onclick="loadConcurrentStatus()">Refresh Status</button>
                </div>
                <div id="concurrent-status-display" class="status-box">
                    <div class="status-item">
                        <span class="status-label">Max Concurrent:</span>
                        <span id="max-concurrent">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Active Requests:</span>
                        <span id="active-requests">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Available Slots:</span>
                        <span id="available-slots">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Can Accept Request:</span>
                        <span id="can-accept-request">-</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Generated Starters</h2>
                <div id="generated-starters" class="starters-box"></div>
            </div>
        </div>

        <!-- Moderation Tab -->
        <div id="moderation-tab" class="tab-content">
            <!-- Content Moderation Flow Diagram -->
            <div class="flow-diagram">
                <div class="flow-title">Content Moderation Pipeline Status</div>
                <div class="flow-container">
                    <span class="flow-step idle" id="mod-step-input">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üìù</div>
                            <div class="flow-step-name">INPUT</div>
                            <div class="flow-step-tech">User Content</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="mod-step-analyze">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üîç</div>
                            <div class="flow-step-name">ANALYZE</div>
                            <div class="flow-step-tech" id="mod-completion-tech">Groq</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="mod-step-score">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">üìä</div>
                            <div class="flow-step-name">SCORE</div>
                            <div class="flow-step-tech">AI Analysis</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="mod-step-decision">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚öñÔ∏è</div>
                            <div class="flow-step-name">DECISION</div>
                            <div class="flow-step-tech">Go API</div>
                        </div>
                    </span>
                    <span class="flow-arrow">‚Üí</span>
                    <span class="flow-step idle" id="mod-step-result">
                        <div class="flow-step-content">
                            <div class="flow-step-icon">‚úÖ</div>
                            <div class="flow-step-name">RESULT</div>
                            <div class="flow-step-tech">UI Display</div>
                        </div>
                    </span>
                </div>
            </div>

            <div class="section">
                <h2>üõ°Ô∏è Analyze Content for Moderation</h2>
                <div class="input-group">
                    <label for="content-text">Enter content to analyze:</label>
                    <textarea id="content-text" placeholder="Enter text content to check for policy violations (toxicity, spam, violence, etc.)..."></textarea>
                </div>
                <div class="quick-content">
                    <strong>Quick Test:</strong>
                    <button onclick="loadToxicExample()">Toxic Example</button>
                    <button onclick="loadBenignExample()">Benign Example</button>
                    <button onclick="loadSpamExample()">Spam Example</button>
                    <button onclick="clearContent()">Clear</button>
                </div>
                <button id="analyze-btn" onclick="handleAnalyze()">üîç Analyze Content</button>
                <div id="analyze-status" class="status-message"></div>
            </div>

            <div class="section">
                <h2>üìä Analysis Results</h2>
                <div id="moderation-results" class="moderation-results">
                    <div class="placeholder">
                        <p>üëÜ Enter content above and click "Analyze Content" to see moderation results</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìà Category Scores</h2>
                <div id="scores-display" class="scores-container">
                    <div class="placeholder">
                        <p>Detailed scores will appear here after analysis</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Log -->
        <div class="status-log">
            <h3>Status Log</h3>
            <div id="log-container" class="log-content"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
